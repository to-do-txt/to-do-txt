// This updated render function highlights tags to match the sidebar colors
function render() {
    const list = document.getElementById('todoList'), search = document.getElementById('searchInput').value.toLowerCase();
    let display = allTasks.map((text, originalIndex) => ({ text, originalIndex, meta: getTaskMeta(text) }));

    // ... (Filter and Sort logic remains same as v2.8.0) ...

    list.innerHTML = display.map(item => {
        if (item.meta.isHeader) return `<div class="pt-8 pb-2 border-b border-[#333] mb-4 text-blue-500 font-black uppercase text-xs tracking-widest">${item.text.replace(/#+\s+/, '')}</div>`;
        
        const isDone = item.text.startsWith('x ');
        
        // HIGHLIGHT LOGIC: Wrap tags in spans with colors matching the sidebar
        let highlightedText = item.text
            .replace(/(\([A-Z]\))/g, '<span class="text-orange-400 font-bold">$1</span>') // Priorities (Orange)
            .replace(/(\+\w+)/g, '<span class="text-blue-400">$1</span>')                 // Projects (Blue)
            .replace(/(@\w+)/g, '<span class="text-green-400">$1</span>')                // Contexts (Green)
            .replace(/(due:\d{4}-\d{2}-\d{2})/g, '<span class="text-yellow-500">$1</span>'); // Due Dates (Yellow)

        const p = item.meta.priority;
        const pClass = isDone ? 'border-l-gray-700 opacity-40' : (p === 'A' ? 'prio-a' : p === 'B' ? 'prio-b' : p === 'C' ? 'prio-c' : 'prio-none');

        return `<div class="group flex items-center bg-[#1e1e1e] border-l-4 ${pClass} mb-1 p-3 hover:bg-[#252525]">
            <input type="checkbox" ${isDone ? 'checked' : ''} onclick="toggleTask(${item.originalIndex})" class="w-4 h-4 mr-4 cursor-pointer">
            <div class="flex-1 text-sm ${isDone ? 'line-through text-gray-500' : ''}">${highlightedText}</div>
            <button onclick="deleteTask(${item.originalIndex})" class="opacity-0 group-hover:opacity-100 text-gray-600 hover:text-red-500 px-2 transition-all">âœ•</button>
        </div>`;
    }).join('');
    updateSidebars();
}
